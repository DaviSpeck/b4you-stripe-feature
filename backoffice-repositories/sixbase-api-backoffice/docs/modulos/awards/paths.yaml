/award-shipments:
  get:
    tags:
      - Awards
    summary: Listar premiações
    description: Retorna uma lista paginada de premiações com informações do produtor e total de comissões
    parameters:
      - name: producer_id
        in: query
        description: Filtrar por ID do produtor
        required: false
        schema:
          type: integer
        example: 123
      - name: producer_uuid
        in: query
        description: Filtrar por UUID do produtor
        required: false
        schema:
          type: string
          format: uuid
        example: '550e8400-e29b-41d4-a716-446655440000'
      - name: milestone
        in: query
        description: Filtrar por marco de vendas
        required: false
        schema:
          type: string
          enum: ['10K', '50K', '500K', '1M', '5M', '10M']
        example: '10K'
      - name: status
        in: query
        description: Filtrar por status
        required: false
        schema:
          type: string
          enum: ['pending', 'sent']
        example: 'pending'
      - name: input
        in: query
        description: Busca por nome, email ou WhatsApp do produtor
        required: false
        schema:
          type: string
        example: 'João Silva'
      - name: start_date
        in: query
        description: Data inicial para filtro (formato YYYY-MM-DD)
        required: false
        schema:
          type: string
          format: date
        example: '2025-01-01'
      - name: end_date
        in: query
        description: Data final para filtro (formato YYYY-MM-DD)
        required: false
        schema:
          type: string
          format: date
        example: '2025-01-31'
      - name: page
        in: query
        description: Índice da página (0-based)
        required: false
        schema:
          type: integer
          default: 0
          minimum: 0
        example: 0
      - name: size
        in: query
        description: Quantidade de itens por página
        required: false
        schema:
          type: integer
          default: 20
          minimum: 1
          maximum: 100
        example: 20
    responses:
      '200':
        description: Lista de premiações obtida com sucesso
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/components/schemas/PagedAwardShipmentsResponse'
            example:
              count: 25
              rows:
                - id: 1
                  producer_id: 123
                  milestone: '10K'
                  status: 'pending'
                  tracking_code: null
                  tracking_link: null
                  achieved_date: '2025-01-15T10:30:00Z'
                  sent_date: null
                  created_at: '2025-01-15T10:30:00Z'
                  updated_at: '2025-01-15T10:30:00Z'
                  producer:
                    id: 123
                    uuid: '550e8400-e29b-41d4-a716-446655440000'
                    full_name: 'João Silva'
                    email: 'joao@email.com'
                    phone: '5511999998888'
                  user_total_comission: 15000.50
      '400':
        $ref: '../../components/common-responses.yaml#/components/responses/BadRequest'
      '401':
        $ref: '../../components/common-responses.yaml#/components/responses/UnauthorizedError'
      '500':
        $ref: '../../components/common-responses.yaml#/components/responses/InternalServerError'

  post:
    tags:
      - Awards
    summary: Criar nova premiação
    description: Cria uma nova premiação para um produtor. Pelo menos um identificador do produtor é obrigatório (producer_id, producer_uuid ou producer_email)
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: './schemas.yaml#/components/schemas/CreateAwardShipmentRequest'
          examples:
            com_producer_id:
              summary: Criar com ID do produtor
              value:
                producer_id: 123
                milestone: '10K'
                achieved_date: '2025-01-15T10:30:00Z'
                status: 'pending'
            com_producer_uuid:
              summary: Criar com UUID do produtor
              value:
                producer_uuid: '550e8400-e29b-41d4-a716-446655440000'
                milestone: '50K'
                achieved_date: '2025-01-15T10:30:00Z'
            com_producer_email:
              summary: Criar com email do produtor
              value:
                producer_email: 'joao@email.com'
                milestone: '100K'
                achieved_date: '2025-01-15T10:30:00Z'
    responses:
      '201':
        description: Premiação criada com sucesso
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/components/schemas/AwardShipment'
            example:
              id: 1
              producer_id: 123
              milestone: '10K'
              status: 'pending'
              tracking_code: null
              tracking_link: null
              achieved_date: '2025-01-15T10:30:00Z'
              sent_date: null
              created_at: '2025-01-15T10:30:00Z'
              updated_at: '2025-01-15T10:30:00Z'
      '400':
        description: Dados inválidos ou identificador do produtor não fornecido
        content:
          application/json:
            schema:
              $ref: '../../components/common-schemas.yaml#/components/schemas/Error'
            example:
              error: 'ValidationError'
              message: 'UUID ou email do produtor é obrigatório'
      '404':
        description: Produtor não encontrado
        content:
          application/json:
            schema:
              $ref: '../../components/common-schemas.yaml#/components/schemas/Error'
            example:
              error: 'NotFoundError'
              message: 'Produtor não encontrado para o UUID informado'
      '409':
        description: Premiação já existe para este produtor e milestone
        content:
          application/json:
            schema:
              $ref: '../../components/common-schemas.yaml#/components/schemas/Error'
            example:
              error: 'ConflictError'
              message: 'Registro já existe para este produtor e milestone'
      '401':
        $ref: '../../components/common-responses.yaml#/components/responses/UnauthorizedError'
      '500':
        $ref: '../../components/common-responses.yaml#/components/responses/InternalServerError'

/award-shipments/{id}:
  patch:
    tags:
      - Awards
    summary: Atualizar premiação
    description: Atualiza os dados de uma premiação existente
    parameters:
      - name: id
        in: path
        required: true
        description: ID da premiação
        schema:
          type: integer
        example: 1
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: './schemas.yaml#/components/schemas/UpdateAwardShipmentRequest'
          example:
            milestone: '50K'
            status: 'sent'
            tracking_code: 'BR123456789BR'
            tracking_link: 'https://www.correios.com.br/rastreamento'
    responses:
      '200':
        description: Premiação atualizada com sucesso
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/components/schemas/AwardShipment'
      '400':
        $ref: '../../components/common-responses.yaml#/components/responses/BadRequest'
      '401':
        $ref: '../../components/common-responses.yaml#/components/responses/UnauthorizedError'
      '404':
        description: Premiação não encontrada
        content:
          application/json:
            schema:
              $ref: '../../components/common-schemas.yaml#/components/schemas/Error'
            example:
              error: 'NotFoundError'
              message: 'Registro não encontrado'
      '500':
        $ref: '../../components/common-responses.yaml#/components/responses/InternalServerError'

  delete:
    tags:
      - Awards
    summary: Deletar premiação
    description: Remove uma premiação do sistema
    parameters:
      - name: id
        in: path
        required: true
        description: ID da premiação
        schema:
          type: integer
        example: 1
    responses:
      '200':
        description: Premiação deletada com sucesso
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/components/schemas/DeleteResponse'
            example:
              success: true
      '400':
        $ref: '../../components/common-responses.yaml#/components/responses/BadRequest'
      '401':
        $ref: '../../components/common-responses.yaml#/components/responses/UnauthorizedError'
      '404':
        description: Premiação não encontrada
        content:
          application/json:
            schema:
              $ref: '../../components/common-schemas.yaml#/components/schemas/Error'
            example:
              error: 'NotFoundError'
              message: 'Registro não encontrado'
      '500':
        $ref: '../../components/common-responses.yaml#/components/responses/InternalServerError'

/award-shipments/{id}/confirm:
  patch:
    tags:
      - Awards
    summary: Confirmar envio da premiação
    description: Confirma o envio de uma premiação, atualizando o status para 'sent' e dados de rastreamento. Automaticamente define a data de envio como atual se não fornecida.
    parameters:
      - name: id
        in: path
        required: true
        description: ID da premiação
        schema:
          type: integer
        example: 1
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: './schemas.yaml#/components/schemas/ConfirmAwardShipmentRequest'
          example:
            tracking_code: 'BR123456789BR'
            tracking_link: 'https://www.correios.com.br/rastreamento'
            sent_date: '2025-01-15T10:30:00Z'
    responses:
      '200':
        description: Envio confirmado com sucesso
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/components/schemas/AwardShipment'
      '400':
        $ref: '../../components/common-responses.yaml#/components/responses/BadRequest'
      '401':
        $ref: '../../components/common-responses.yaml#/components/responses/UnauthorizedError'
      '404':
        description: Premiação não encontrada
        content:
          application/json:
            schema:
              $ref: '../../components/common-schemas.yaml#/components/schemas/Error'
            example:
              error: 'NotFoundError'
              message: 'Registro não encontrado'
      '500':
        $ref: '../../components/common-responses.yaml#/components/responses/InternalServerError'
