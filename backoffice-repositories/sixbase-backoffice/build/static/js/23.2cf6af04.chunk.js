"use strict";(self.webpackChunksixbase_backoffice=self.webpackChunksixbase_backoffice||[]).push([[23],{6878:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(9950),r=n(5393),o=n.n(r);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l.apply(this,arguments)}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=(0,a.forwardRef)(function(e,t){var n=e.color,r=void 0===n?"currentColor":n,o=e.size,c=void 0===o?24:o,i=s(e,["color","size"]);return a.createElement("svg",l({ref:t,xmlns:"http://www.w3.org/2000/svg",width:c,height:c,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},i),a.createElement("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.createElement("polyline",{points:"7 10 12 15 17 10"}),a.createElement("line",{x1:"12",y1:"15",x2:"12",y2:"3"}))});c.propTypes={color:o().string,size:o().oneOfType([o().string,o().number])},c.displayName="Download";const i=c},7609:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(77265),r=n(44414);function o(e){let{size:t=24,className:n="",text:o="Carregando...",showText:l=!1}=e;return(0,r.jsxs)("div",{className:"d-flex flex-column align-items-center ".concat(n),children:[(0,r.jsx)(a.A,{size:t,style:{animation:"spin 1s linear infinite"}}),l&&(0,r.jsx)("span",{className:"mt-2 text-muted",children:o})]})}},28285:()=>{},33006:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(9950),r=n(5393),o=n.n(r);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l.apply(this,arguments)}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=(0,a.forwardRef)(function(e,t){var n=e.color,r=void 0===n?"currentColor":n,o=e.size,c=void 0===o?24:o,i=s(e,["color","size"]);return a.createElement("svg",l({ref:t,xmlns:"http://www.w3.org/2000/svg",width:c,height:c,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},i),a.createElement("circle",{cx:"11",cy:"11",r:"8"}),a.createElement("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}))});c.propTypes={color:o().string,size:o().oneOfType([o().string,o().number])},c.displayName="Search";const i=c},77265:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(9950),r=n(5393),o=n.n(r);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l.apply(this,arguments)}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=(0,a.forwardRef)(function(e,t){var n=e.color,r=void 0===n?"currentColor":n,o=e.size,c=void 0===o?24:o,i=s(e,["color","size"]);return a.createElement("svg",l({ref:t,xmlns:"http://www.w3.org/2000/svg",width:c,height:c,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},i),a.createElement("line",{x1:"12",y1:"2",x2:"12",y2:"6"}),a.createElement("line",{x1:"12",y1:"18",x2:"12",y2:"22"}),a.createElement("line",{x1:"4.93",y1:"4.93",x2:"7.76",y2:"7.76"}),a.createElement("line",{x1:"16.24",y1:"16.24",x2:"19.07",y2:"19.07"}),a.createElement("line",{x1:"2",y1:"12",x2:"6",y2:"12"}),a.createElement("line",{x1:"18",y1:"12",x2:"22",y2:"12"}),a.createElement("line",{x1:"4.93",y1:"19.07",x2:"7.76",y2:"16.24"}),a.createElement("line",{x1:"16.24",y1:"7.76",x2:"19.07",y2:"4.93"}))});c.propTypes={color:o().string,size:o().oneOfType([o().string,o().number])},c.displayName="Loader";const i=c},90523:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var a=n(89379),r=n(59051),o=n.n(r),l=n(9950),s=n(45530),c=n(35203),i=n(29251),d=n(98664),u=n(33006),p=n(6878),m=n(5393),f=n.n(m);function x(){return x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},x.apply(this,arguments)}function h(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var v=(0,l.forwardRef)(function(e,t){var n=e.color,a=void 0===n?"currentColor":n,r=e.size,o=void 0===r?24:r,s=h(e,["color","size"]);return l.createElement("svg",x({ref:t,xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},s),l.createElement("polyline",{points:"23 4 23 10 17 10"}),l.createElement("polyline",{points:"1 20 1 14 7 14"}),l.createElement("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"}))});v.propTypes={color:f().string,size:f().oneOfType([f().string,f().number])},v.displayName="RefreshCw";const g=v;var y=n(7609),j=n(34964),b=(n(94300),n(28285),n(30639)),w=n(11749),O=n(13955),Y=n(96690),E=n(12449),k=n(56561),S=n(13467),D=n(44414);const C=(0,w.A)((e,t)=>[{name:"Data",cell:e=>o()(null===e||void 0===e?void 0:e.created_at).format("DD/MM/YYYY HH:mm:ss"),width:"110px"},{name:"Produto",cell:e=>{var t,n,a,r;return(0,D.jsx)(Y.N_,{to:"/producer/".concat(null===e||void 0===e||null===(t=e.product)||void 0===t||null===(n=t.producer)||void 0===n?void 0:n.uuid,"/product/").concat(null===e||void 0===e||null===(a=e.product)||void 0===a?void 0:a.uuid),children:null===e||void 0===e||null===(r=e.product)||void 0===r?void 0:r.name})},minWidth:"190px"},{name:"Cliente",cell:e=>{var t,n;return(0,D.jsx)(Y.N_,{to:"/student/".concat(null===e||void 0===e||null===(t=e.student)||void 0===t?void 0:t.uuid),children:null===e||void 0===e||null===(n=e.student)||void 0===n?void 0:n.full_name})},minWidth:"220px"},{name:"Valor",cell:e=>(0,O.cC)(null===e||void 0===e?void 0:e.price),width:"110px"},{name:"Metodo",width:"90px",cell:e=>"Cart\xe3o de Cr\xe9dito"===e.payment_method.label?"Cart\xe3o":e.payment_method.label},{name:"Status",cell:e=>{var t;return(0,D.jsx)(c.Ex,{color:null===e||void 0===e||null===(t=e.status)||void 0===t?void 0:t.color,children:"Aguardando Pagamento"===e.status.name?"Pendente":e.status.name})},width:"90px"},{name:"Afiliado",cell:e=>{let{affiliate:t}=e;return t?(0,D.jsx)(Y.N_,{to:"/producer/".concat(t.uuid),children:t.full_name}):" - "}},{name:"Pago em",cell:e=>null===e||void 0===e?void 0:e.paid_at,minWidth:"110px"},{name:"Detalhes",cell:n=>(0,D.jsx)(c.Ex,{color:"primary",style:{cursor:"pointer"},onClick:()=>{t(n.student.uuid,n.uuid),e(!0)},children:(0,D.jsx)(i.A,{size:21})})}]),_={position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0},N=new Map,M=()=>{const e=(0,l.useRef)(null),[t,n]=(0,l.useState)(null),[r,i]=(0,l.useState)(null),[m,f]=(0,l.useState)(0),[x,h]=(0,l.useState)(10),[v,w]=(0,l.useState)(!1),[Y,M]=(0,l.useState)({page:1,size:10,totalRows:0,calendar:[o()().startOf("month").toDate(),o()().toDate()]}),[P,R]=(0,l.useState)(null),[z,A]=(0,l.useState)(!1),[T,L]=(0,l.useState)(null),[B,F]=(0,l.useState)("all"),[I,W]=(0,l.useState)("all"),[U,$]=(0,l.useState)(null),[H,Z]=(0,l.useState)(null),[V,q]=(0,l.useState)(""),[G,J]=(0,l.useState)(0),[K,Q]=(0,l.useState)(!0),[X,ee]=(0,l.useState)(!1),{skin:te}=(0,S.h)();(0,l.useEffect)(()=>{ne()},[Y,B,I]),(0,l.useEffect)(()=>(e.current&&clearTimeout(e.current),e.current=setTimeout(()=>{ae(0,null,V)},500),()=>{e.current&&clearTimeout(e.current)}),[V,Y,B,I,X]);const ne=()=>{R(!0),s.F.get("/sales/status").then(e=>L(e.data)).catch(e=>console.log(e)),R(!1)};(0,l.useEffect)(()=>{s.F.get("/sales/card-approval?start_date=".concat(o()(Y.calendar[0]).format("YYYY-MM-DD"),"&end_date=").concat(o()(Y.calendar[1]).format("YYYY-MM-DD"))).then(e=>{let{data:t}=e;J(t.card_approval),Q(!1)}).catch(e=>console.log(e))},[Y.calendar]);const ae=(0,l.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const r=t||x,l="sales_".concat(e,"_").concat(r,"_").concat(a,"_").concat(B,"_").concat(I,"_").concat(o()(Y.calendar[0]).format("YYYY-MM-DD"),"_").concat(o()(Y.calendar[1]).format("YYYY-MM-DD")),c=N.get(l);if(c&&Date.now()-c.timestamp<12e4)return n(c.data.rows),i(c.data.total),void f(c.data.count);R(!0);try{const t=new URLSearchParams;t.append("page",e.toString()),t.append("size",r.toString()),t.append("id_status",B),t.append("payment_method",I),a&&t.append("input",a);const c=await s.F.get("/sales/overall?start_date=".concat(o()(Y.calendar[0]).format("YYYY-MM-DD"),"&end_date=").concat(o()(Y.calendar[1]).format("YYYY-MM-DD"),"&").concat(t.toString()));N.set(l,{data:c.data,timestamp:Date.now()}),n(c.data.rows),i(c.data.total),f(c.data.count)}catch(d){console.log(d)}R(!1)},[x,Y.calendar,B,I]),re=(0,l.useCallback)(async(e,t)=>{await ae(t-1,e,V),h(e)},[ae,V]),oe=(0,l.useCallback)(e=>{ae(e-1,null,V)},[ae,V]),le=(0,l.useCallback)(()=>{if(o()(Y.calendar[1]).diff(o()(Y.calendar[0]),"d")>31)return void E.oR.error("Selecione o m\xe1ximo de 31 dias para exportar as vendas",_);E.oR.success("Exportando... Essa opera\xe7\xe3o pode demorar",_),A(!0);const e=new URLSearchParams;e.append("payment_method",I),e.append("id_status",B),V&&e.append("input",V),s.F.get("sales/export?start_date=".concat(o()(Y.calendar[0]).format("YYYY-MM-DD"),"&end_date=").concat(o()(Y.calendar[1]).format("YYYY-MM-DD"),"&format=xlsx&").concat(e.toString()),{responseType:"blob"}).then(e=>{const t=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a");n.href=t,n.setAttribute("download","vendas_".concat(o()(Y.calendar[0]).format("YYYY-MM-DD"),"_").concat(o()(Y.calendar[1]).format("YYYY-MM-DD"),".xlsx")),document.body.appendChild(n),n.click(),E.oR.success("Exportado com sucesso",_)}).catch(e=>E.oR.error("Erro ao baixar arquivo",_)).finally(()=>A(!1))},[Y.calendar,I,B,V]),se=((0,l.useCallback)(()=>{if(o()(Y.calendar[1]).diff(o()(Y.calendar[0]),"d")>31)return void E.oR.error("Selecione o m\xe1ximo de 31 dias para exportar as vendas",_);E.oR.success("Exportando... Essa opera\xe7\xe3o pode demorar",_),A(!0);const e=new URLSearchParams;e.append("payment_method",I),e.append("id_status",B),V&&e.append("input",V),s.F.get("sales/export-charges?start_date=".concat(o()(Y.calendar[0]).format("YYYY-MM-DD"),"&end_date=").concat(o()(Y.calendar[1]).format("YYYY-MM-DD"),"&format=xlsx&").concat(e.toString()),{responseType:"blob"}).then(e=>{const t=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a");n.href=t,n.setAttribute("download","cobrancas_".concat(o()(Y.calendar[0]).format("YYYY-MM-DD"),"_").concat(o()(Y.calendar[1]).format("YYYY-MM-DD"),".xlsx")),document.body.appendChild(n),n.click(),E.oR.success("Exportado com sucesso",_)}).catch(e=>E.oR.error("Erro ao baixar arquivo",_)).finally(()=>A(!1))},[Y.calendar,I,B,V]),(e,t)=>{R(!0),s.F.get("/sales/".concat(t)).then(e=>{Z(e.data)}).catch(e=>console.log(e)),R(!1)});return(0,D.jsx)("section",{id:"pageSales",children:T&&t&&(0,D.jsxs)(D.Fragment,{children:[H&&(0,D.jsx)(k.A,{student:U,show:v,toggle:()=>w(!v),data:H,canRefund:!1,getStudentData:se}),(0,D.jsx)(c.Zp,{children:(0,D.jsxs)(c.aR,{className:"flex-sm-row flex-column justify-content-sm-between justify-content-center align-items-sm-center align-items-start",children:[(0,D.jsxs)(c.ZB,{tag:"h4",children:[(0,D.jsx)("h5",{className:"mb-0",children:"Total"}),(0,D.jsx)("div",{className:"h3 pt-0 pb-0 text-primary",children:null!==r&&r>=0?(0,O.cC)(r):(0,D.jsx)(c.y$,{})})]}),(0,D.jsxs)(c.ZB,{tag:"h4",children:[(0,D.jsx)("h5",{className:"mb-0",children:"Aprova\xe7\xe3o Cart\xe3o %"}),(0,D.jsx)("div",{className:"h3 pt-0 pb-0 text-primary",children:K?(0,D.jsx)(c.y$,{}):"".concat((100*G).toFixed(2)," %")})]}),(0,D.jsxs)("div",{className:"d-flex flex-row",children:[(0,D.jsxs)("div",{className:"d-flex align-items-center ml-2",children:[(0,D.jsx)(d.A,{size:15,className:"ml-2"}),(0,D.jsx)(j.A,{className:"form-control flat-picker bg-transparent border-0 shadow-none",style:{width:"210px"},value:Y.calendar,onChange:e=>M(t=>(0,a.A)((0,a.A)({},t),{},{calendar:e})),options:{mode:"range",dateFormat:"d/m/Y"}})]}),(0,D.jsxs)("div",{className:"d-flex gap-1",children:[(0,D.jsx)("div",{className:"d-flex",children:(0,D.jsxs)("select",{name:"status",onChange:e=>{e.preventDefault();const t=e.target.value;F(t)},children:[(0,D.jsx)("option",{value:"all",children:"Todos"}),T.map(e=>(0,D.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,D.jsx)("div",{className:"d-flex",children:(0,D.jsxs)("select",{name:"payment",className:"ml-2",onChange:e=>{e.preventDefault();const t=e.target.value;W(t)},children:[(0,D.jsx)("option",{value:"all",children:"Todos"}),(0,D.jsx)("option",{value:"pix",children:"Pix"}),(0,D.jsx)("option",{value:"billet",children:"Boleto"}),(0,D.jsx)("option",{value:"card",children:"Cart\xe3o"})]})})]})]})]})}),(0,D.jsx)(c.Zp,{children:(0,D.jsx)(c.bw,{children:(0,D.jsxs)(c.fI,{className:"mb-2",children:[(0,D.jsx)(c.fv,{md:"6",children:(0,D.jsxs)("div",{className:"d-flex align-items-center",children:[(0,D.jsx)(u.A,{size:16,className:"me-2"}),(0,D.jsx)(c.pd,{type:"text",placeholder:"ID / Nome do produto / Nome do cliente / E-mail ou CPF",value:V,onChange:e=>{q(e.target.value)}})]})}),(0,D.jsx)(c.fv,{md:"6",className:"d-flex justify-content-end",children:(0,D.jsx)("div",{className:"d-flex gap-2",children:(0,D.jsxs)(c.$n,{color:"primary",onClick:le,className:"d-inline-flex align-items-center",children:[z?(0,D.jsx)(y.A,{}):(0,D.jsx)(p.A,{size:16}),(0,D.jsx)("span",{className:"ms-2",children:z?"Exportando...":"Exportar Vendas"})]})})})]})})}),(0,D.jsx)(c.fI,{children:(0,D.jsxs)(c.fv,{children:[(0,D.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,D.jsx)("h3",{className:"mb-0",children:"Vendas"}),(0,D.jsx)(c.$n,{color:"primary",onClick:()=>{ee(!X)},children:P?(0,D.jsx)(c.y$,{size:"sm"}):(0,D.jsx)(g,{size:15})})]}),(0,D.jsx)(b.Ay,{columns:C(w,se),data:t,progressPending:P,pagination:!0,paginationServer:!0,paginationTotalRows:m,onChangeRowsPerPage:re,onChangePage:oe,paginationComponentOptions:{rowsPerPageText:"Linhas por p\xe1gina:",rangeSeparatorText:"de",noRowsPerPage:!1},progressComponent:(0,D.jsx)(c.y$,{}),noDataComponent:(0,D.jsx)(D.Fragment,{children:"N\xe3o h\xe1 vendas"}),theme:"dark"===te?"solarized":"solarizedLight",paginationRowsPerPageOptions:[10,20,50,100]})]})})]})})}},94300:()=>{},98664:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(9950),r=n(5393),o=n.n(r);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l.apply(this,arguments)}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=(0,a.forwardRef)(function(e,t){var n=e.color,r=void 0===n?"currentColor":n,o=e.size,c=void 0===o?24:o,i=s(e,["color","size"]);return a.createElement("svg",l({ref:t,xmlns:"http://www.w3.org/2000/svg",width:c,height:c,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},i),a.createElement("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),a.createElement("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),a.createElement("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),a.createElement("line",{x1:"3",y1:"10",x2:"21",y2:"10"}))});c.propTypes={color:o().string,size:o().oneOfType([o().string,o().number])},c.displayName="Calendar";const i=c}}]);