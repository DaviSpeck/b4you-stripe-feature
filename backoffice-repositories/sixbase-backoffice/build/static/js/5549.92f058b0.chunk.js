(self.webpackChunksixbase_backoffice=self.webpackChunksixbase_backoffice||[]).push([[5549],{16251:()=>{},29800:()=>{},61045:(e,a,n)=>{"use strict";n.d(a,{A:()=>d});var s=n(9950),r=n(35203),l=n(89379),t=n(80045),o=n(44414);const i=["variant","size","warn","text","icon","textButton","className","style","buttonWhite","children"],c=e=>{let{variant:a="danger",size:n="md",warn:s="Aviso:",text:r="H\xe1 algo de errado",icon:c="bx-error",textButton:d,className:m,style:u,buttonWhite:h=!0,children:x}=e,g=(0,t.A)(e,i);return(0,o.jsxs)("div",(0,l.A)((0,l.A)({className:"alertDS alertDS-".concat(a," alertDS-size-").concat(n," ").concat(m)},g),{},{style:u,children:[(0,o.jsxs)("div",{className:c&&"alertDS-wrap-icon",style:{display:!c&&"none"},children:[(0,o.jsx)("i",{className:"bx ".concat(c)}),(0,o.jsx)("span",{className:"alertDS-heading",children:s})]}),(0,o.jsx)("span",{className:"alertDS-text",children:r}),x]}))},d=e=>{let{show:a,setShow:n,footer:l,centered:t,title:i="Confirmar a\xe7\xe3o",confirmText:d="Confirmo",buttonText:m="Confirmar A\xe7\xe3o",description:u,handleAction:h,simpleConfirm:x,variant:g="danger",variantButton:p="danger",textAlert:j="Essa opera\xe7\xe3o n\xe3o poder\xe1 ser desfeita.",haveLoader:v=!0}=e;const[f,k]=(0,s.useState)(""),[C,N]=(0,s.useState)(!1),w=()=>{n(!1)};return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(r.aF,{isOpen:a,toggle:()=>w(),centered:t,className:"modal-generic modal-confirm-action",children:[(0,o.jsx)(r.rQ,{children:i}),(0,o.jsxs)(r.cw,{children:[(0,o.jsx)("div",{className:"mb-4",children:(0,o.jsx)(c,{warn:"Aviso:",variant:g,text:j})}),u?(0,o.jsx)("p",{children:u}):(0,o.jsx)("p",{children:"Ao apertar o bot\xe3o abaixo a a\xe7\xe3o tomada n\xe3o poder\xe1 ser desfeita!"}),(0,o.jsx)("b",{className:"mr-2",children:"Voc\xea tem certeza que quer tomar esta a\xe7\xe3o?"}),x?(0,o.jsx)("span",{children:"Aperte o bot\xe3o para confirmar."}):(0,o.jsxs)("span",{children:['Digite o termo "',(0,o.jsx)("b",{children:d}),'" no campo abaixo.']}),x?(0,o.jsx)(r.fI,{className:"mt-4",children:(0,o.jsxs)(r.fv,{className:"d-flex justify-content-between",children:[(0,o.jsx)(r.$n,{variant:p,size:"sm",onClick:()=>{n(!1)},outline:!0,children:"Cancelar"}),(0,o.jsx)(r.$n,{variant:p,size:"sm",onClick:e=>{v&&N(!0),h(e)},disabled:C,children:C?"Carregando...":m})]})}):(0,o.jsxs)(r.fI,{className:"mt-4",children:[(0,o.jsx)(r.fv,{md:12,children:(0,o.jsx)(r.lV.Control,{className:"text-center",placeholder:'Digite "'.concat(d,'"'),onKeyUp:e=>{k(e.target.value)}})}),(0,o.jsx)(r.fv,{className:"d-flex justify-content-end",children:(0,o.jsx)("div",{className:"mt-4",children:(0,o.jsx)(r.$n,{variant:p,size:"xs",onClick:e=>{v&&N(!0),h(e)},disabled:f.toLowerCase().replace(/\s/g,"")!==d.toLowerCase().replace(/\s/g,"")||C,children:(0,o.jsx)("span",{style:{fontSize:16},children:C?"Carregando...":m})})})})]})]}),l&&(0,o.jsx)(r.jl,{children:(0,o.jsx)(r.$n,{size:"sm",variant:"light",onClick:w,children:"Fechar"})})]})})}},67233:()=>{},77764:(e,a,n)=>{"use strict";n.r(a),n.d(a,{default:()=>U});var s=n(89379),r=n(9950),l=n(35203),t=n(29251),o=n(68331),i=n(59051),c=n.n(i),d=n(45530),m=n(61045),u=n(48525),h=n(13467),x=n(11749),g=n(13955),p=n(42959),j=n(66146),v=n(44414);const f=e=>{let{onUploadClick:a,onCreateClick:n}=e;return(0,v.jsxs)("div",{className:"mb-4 d-flex justify-content-between align-items-center",children:[(0,v.jsx)("h1",{className:"mb-0",children:"Premia\xe7\xf5es"}),(0,v.jsxs)("div",{className:"d-flex gap-2",children:[(0,v.jsxs)(l.$n,{color:"success",onClick:a,className:"d-flex align-items-center",children:[(0,v.jsx)(p.A,{size:16,className:"me-2"}),"Upload em Lote"]}),(0,v.jsxs)(l.$n,{color:"primary",onClick:n,className:"d-flex align-items-center",children:[(0,v.jsx)(j.A,{size:16,className:"me-2"}),"Cadastrar Premia\xe7\xe3o"]})]})]})},k=e=>{let{milestones:a,selectedMilestone:n,onMilestoneChange:s}=e;return(0,v.jsx)("div",{className:"mb-4",children:(0,v.jsx)("div",{className:"d-flex gap-2 flex-wrap",children:a.map(e=>(0,v.jsx)(l.$n,{color:n===e?"primary":"secondary",outline:n!==e,onClick:()=>s(e),className:"px-3",children:e},e))})})};var C=n(9564),N=n(57795),w=n(98664),_=n(34964);n(94300);const y=e=>{let{activeTab:a,onTabChange:n,pendingTotal:s,sentTotal:r,filter:t,onDateChange:o,onQuickRange:i,onClearFilter:c,searchText:d,onSearchChange:m}=e;return(0,v.jsxs)("div",{className:"d-flex align-items-center mb-3 gap-3",children:[(0,v.jsxs)(l.so,{tabs:!0,className:"mb-0 flex-shrink-0",children:[(0,v.jsx)(l.CI,{children:(0,v.jsxs)(l.k2,{className:"pending"===a?"active":"",onClick:()=>n("pending"),style:{cursor:"pointer"},children:[(0,v.jsx)(C.A,{size:16,className:"me-2"}),"Pendentes (",s,")"]})}),(0,v.jsx)(l.CI,{children:(0,v.jsxs)(l.k2,{className:"sent"===a?"active":"",onClick:()=>n("sent"),style:{cursor:"pointer"},children:[(0,v.jsx)(N.A,{size:16,className:"me-2"}),"Enviados (",r,")"]})})]}),(0,v.jsxs)("div",{className:"d-flex align-items-center",children:[(0,v.jsx)(w.A,{size:15}),(0,v.jsx)(_.A,{className:"form-control flat-picker bg-transparent border-0 shadow-none",style:{width:"210px"},value:t.calendar.length>0?t.calendar:void 0,onChange:o,options:{mode:"range",dateFormat:"d/m/Y",placeholder:"Selecionar data",allowInput:!0,defaultDate:null},placeholder:"Selecionar data"}),(0,v.jsxs)("div",{className:"d-flex gap-1",children:[(0,v.jsx)(l.$n,{size:"sm",color:"primary",onClick:()=>{const e=new Date;o([e,e])},children:"Hoje"}),(0,v.jsx)(l.$n,{size:"sm",color:"primary",onClick:()=>i(7),children:"7 dias"}),(0,v.jsx)(l.$n,{size:"sm",color:"primary",onClick:()=>i(30),children:"30 dias"}),(0,v.jsx)(l.$n,{size:"sm",color:"secondary",onClick:c,children:"Limpar"})]})]}),(0,v.jsx)("div",{className:"flex-grow-1",children:(0,v.jsx)(l.pd,{type:"text",value:d,onChange:e=>m(e.target.value),placeholder:"Buscar por nome, email ou telefone",className:"w-100"})})]})};var b=n(30639);const A=e=>{let{activeTab:a,pendingProducers:n,sentProducers:s,pendingTotal:r,sentTotal:t,loading:o,skin:i,pendingColumns:c,sentColumns:d,onPendingPageChange:m,onPendingRowsPerPageChange:u,onSentPageChange:h,onSentRowsPerPageChange:x}=e;return(0,v.jsxs)(l.JS,{activeTab:a,children:[(0,v.jsx)(l.mF,{tabId:"pending",children:(0,v.jsx)(b.Ay,{columns:c,data:n,pagination:!0,progressPending:o,progressComponent:(0,v.jsx)("span",{children:"Carregando..."}),paginationServer:!0,paginationTotalRows:r,onChangePage:m,onChangeRowsPerPage:u,paginationComponentOptions:{noRowsPerPage:!0,rangeSeparatorText:"de"},theme:"dark"===i?"solarized":"solarizedLight",noDataComponent:(0,v.jsx)("div",{className:"text-center py-4",children:(0,v.jsx)("p",{className:"text-muted mb-0",children:"Nenhuma recompensa pendente para este marco"})})})}),(0,v.jsx)(l.mF,{tabId:"sent",children:(0,v.jsx)(b.Ay,{columns:d,data:s,pagination:!0,progressPending:o,progressComponent:(0,v.jsx)("span",{children:"Carregando..."}),paginationServer:!0,paginationTotalRows:t,onChangePage:h,onChangeRowsPerPage:x,paginationComponentOptions:{noRowsPerPage:!0,rangeSeparatorText:"de"},theme:"dark"===i?"solarized":"solarizedLight",noDataComponent:(0,v.jsx)("div",{className:"text-center py-4",children:(0,v.jsx)("p",{className:"text-muted mb-0",children:"Nenhuma recompensa enviada para este marco"})})})})]})},S=e=>{let{isOpen:a,onToggle:n,selectedMilestone:s,createForm:r,onFormChange:t,onCreateAward:o,loading:i}=e;const c=r.producer_uuid.trim()||r.producer_email.trim();return(0,v.jsxs)(l.aF,{isOpen:a,toggle:n,centered:!0,size:"lg",children:[(0,v.jsx)(l.rQ,{toggle:n,children:"Cadastrar Nova Premia\xe7\xe3o"}),(0,v.jsx)(l.cw,{children:(0,v.jsx)("div",{className:"row",children:(0,v.jsxs)("div",{className:"col-12",children:[(0,v.jsxs)("h6",{className:"mb-3",children:["Marco Selecionado: ",s]}),(0,v.jsx)("div",{className:"row",children:(0,v.jsx)("div",{className:"col-md-6",children:(0,v.jsxs)(l.gE,{children:[(0,v.jsx)(l.JU,{for:"producerEmail",children:"Email do Produtor"}),(0,v.jsx)(l.pd,{type:"email",id:"producerEmail",value:r.producer_email,onChange:e=>t("producer_email",e.target.value),placeholder:"Digite o email do produtor"}),(0,v.jsx)("small",{className:"text-muted",children:"Email do produtor no sistema"})]})})}),(0,v.jsxs)("div",{className:"row",children:[(0,v.jsx)("div",{className:"col-md-6",children:(0,v.jsxs)(l.gE,{children:[(0,v.jsx)(l.JU,{children:"Data de Conquista"}),(0,v.jsx)(l.pd,{type:"text",value:(new Date).toLocaleDateString("pt-BR"),disabled:!0,className:"bg-light"}),(0,v.jsx)("small",{className:"text-muted",children:"Data atual (autom\xe1tica)"})]})}),(0,v.jsx)("div",{className:"col-md-6",children:(0,v.jsxs)(l.gE,{children:[(0,v.jsx)(l.JU,{children:"Marco de Receita"}),(0,v.jsx)(l.pd,{type:"text",value:s,disabled:!0,className:"bg-light"}),(0,v.jsx)("small",{className:"text-muted",children:"Marco selecionado (autom\xe1tico)"})]})})]}),(0,v.jsxs)("div",{className:"row",children:[(0,v.jsx)("div",{className:"col-md-6",children:(0,v.jsxs)(l.gE,{children:[(0,v.jsx)(l.JU,{for:"trackingCode",children:"C\xf3digo de Rastreamento (Opcional)"}),(0,v.jsx)(l.pd,{type:"text",id:"trackingCode",value:r.tracking_code,onChange:e=>t("tracking_code",e.target.value),placeholder:"Digite o c\xf3digo de rastreamento"})]})}),(0,v.jsx)("div",{className:"col-md-6",children:(0,v.jsxs)(l.gE,{children:[(0,v.jsx)(l.JU,{for:"trackingLink",children:"Link de Rastreamento (Opcional)"}),(0,v.jsx)(l.pd,{type:"url",id:"trackingLink",value:r.tracking_link,onChange:e=>t("tracking_link",e.target.value),placeholder:"Digite o link de rastreamento"})]})})]})]})})}),(0,v.jsxs)(l.jl,{children:[(0,v.jsx)(l.$n,{color:"secondary",onClick:n,children:"Cancelar"}),(0,v.jsxs)(l.$n,{color:"primary",onClick:o,disabled:!c||i,children:[i?(0,v.jsx)(l.y$,{size:"sm",className:"me-2"}):null,"Cadastrar Premia\xe7\xe3o"]})]})]})};var E=n(81745),P=n(96341);const D=e=>{var a,n;let{isOpen:s,onToggle:r,editingProducer:t,editForm:o,onFormChange:i,onUpdateAward:c,onDeleteAward:d,onBlockAward:m,loading:u,blocking:h,getProducerData:x}=e;const g=(null===(a=o.tracking_code)||void 0===a?void 0:a.trim())||(null===(n=o.tracking_link)||void 0===n?void 0:n.trim());return(0,v.jsxs)(l.aF,{isOpen:s,toggle:r,centered:!0,size:"lg",children:[(0,v.jsx)(l.rQ,{toggle:r,children:"pending"===(null===t||void 0===t?void 0:t.status)?"Enviar Premia\xe7\xe3o":"Atualizar Premia\xe7\xe3o"}),(0,v.jsxs)(l.cw,{children:[t&&(0,v.jsxs)("div",{className:"mb-2",children:[(0,v.jsxs)("h6",{className:"d-flex align-items-center gap-2",children:[(0,v.jsxs)("span",{children:["Produtor: ",x(t).full_name]}),m&&(0,v.jsxs)(l.$n,{color:"danger",size:"sm",onClick:m,className:"d-flex align-items-center text-white",style:{padding:"4px 4px"},disabled:h,children:[h?(0,v.jsx)(l.y$,{size:"sm",color:"light",className:"me-1"}):(0,v.jsx)(E.A,{size:16,className:"me-1"}),"Bloquear Premia\xe7\xe3o"]})]}),(0,v.jsxs)("div",{className:"mb-0 mt-2 d-flex align-items-center gap-4",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("small",{children:"Email: "}),(0,v.jsx)("a",{href:"mailto:".concat(x(t).email),className:"text-info text-decoration-none",style:{cursor:"pointer"},children:(0,v.jsx)("small",{children:x(t).email})})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("small",{children:"Telefone: "}),(0,v.jsx)("a",{href:"https://wa.me/55".concat(x(t).phone.replace(/\D/g,"")),target:"_blank",rel:"noopener noreferrer",className:"text-success text-decoration-none",style:{cursor:"pointer"},children:(0,v.jsx)("small",{children:x(t).phone})})]})]})]}),(0,v.jsxs)("div",{className:"row",children:[(0,v.jsx)("div",{className:"col-md-6",children:(0,v.jsxs)(l.gE,{children:[(0,v.jsx)(l.JU,{for:"editTrackingCode",children:"C\xf3digo de Rastreamento"}),(0,v.jsx)(l.pd,{type:"text",id:"editTrackingCode",value:o.tracking_code,onChange:e=>i("tracking_code",e.target.value),placeholder:"Digite o c\xf3digo de rastreamento (ou '-' se n\xe3o houver)"}),(0,v.jsx)("small",{className:"text-muted",children:"pending"===(null===t||void 0===t?void 0:t.status)?'Digite o c\xf3digo de rastreamento ou "-" se n\xe3o houver':"Edite o c\xf3digo de rastreamento se necess\xe1rio"})]})}),(0,v.jsx)("div",{className:"col-md-6",children:(0,v.jsxs)(l.gE,{children:[(0,v.jsx)(l.JU,{for:"editTrackingLink",children:"Link de Rastreamento"}),(0,v.jsx)(l.pd,{type:"url",id:"editTrackingLink",value:o.tracking_link,onChange:e=>i("tracking_link",e.target.value),placeholder:"Digite o link de rastreamento (ou '-' se n\xe3o houver)"}),(0,v.jsx)("small",{className:"text-muted",children:"pending"===(null===t||void 0===t?void 0:t.status)?'Digite o link de rastreamento ou "-" se n\xe3o houver':"Edite o link de rastreamento se necess\xe1rio"})]})})]})]}),(0,v.jsx)(l.jl,{children:(0,v.jsxs)("div",{className:"d-flex justify-content-between w-100",children:[(0,v.jsxs)(l.$n,{color:"danger",onClick:d,disabled:u,className:"d-flex align-items-center",children:[(0,v.jsx)(P.A,{size:16,className:"me-2"}),"Excluir Premia\xe7\xe3o"]}),(0,v.jsxs)("div",{className:"d-flex gap-2",children:[(0,v.jsx)(l.$n,{color:"secondary",onClick:r,children:"Cancelar"}),(0,v.jsxs)(l.$n,{color:"primary",onClick:c,disabled:u||!g,children:[u?(0,v.jsx)(l.y$,{size:"sm",className:"me-2"}):null,"pending"===(null===t||void 0===t?void 0:t.status)?"Enviar Premia\xe7\xe3o":"Atualizar Premia\xe7\xe3o"]})]})]})})]})},T=e=>{let{isOpen:a,onToggle:n,selectedMilestone:s,uploadEmails:r,uploadResults:t,uploadLoading:o,onFileChange:i,onBulkUpload:c}=e;return(0,v.jsxs)(l.aF,{isOpen:a,toggle:n,centered:!0,size:"lg",children:[(0,v.jsx)(l.rQ,{toggle:n,children:"Upload em Lote - Premia\xe7\xf5es"}),(0,v.jsxs)(l.cw,{children:[(0,v.jsxs)("div",{className:"mb-3",children:[(0,v.jsxs)("h6",{className:"mb-3",children:["Marco Selecionado: ",s]}),(0,v.jsx)(l.Fc,{color:"info",className:"mb-3",children:(0,v.jsxs)("small",{children:[(0,v.jsx)("strong",{children:"Instru\xe7\xf5es:"})," Fa\xe7a upload de uma planilha Excel (.xlsx) com os emails dos produtores na primeira coluna (coluna A). Cada linha deve conter um email v\xe1lido."]})})]}),(0,v.jsxs)(l.gE,{children:[(0,v.jsx)(l.JU,{for:"excelFile",children:"Arquivo Excel"}),(0,v.jsx)(l.pd,{type:"file",id:"excelFile",accept:".xlsx,.xls",onChange:e=>{var a;const n=null===(a=e.target.files)||void 0===a?void 0:a[0];n&&i(n)}}),(0,v.jsx)("small",{className:"text-muted",children:"Formatos aceitos: .xlsx, .xls"})]}),r.length>0&&(0,v.jsxs)("div",{className:"mt-3",children:[(0,v.jsxs)("h6",{children:["Emails encontrados (",r.length,"):"]}),(0,v.jsx)("div",{className:"border rounded p-2",style:{maxHeight:"200px",overflowY:"auto",backgroundColor:"#f8f9fa"},children:r.map((e,a)=>(0,v.jsx)("div",{className:"mb-1",children:(0,v.jsxs)("small",{className:"text-muted",children:[a+1,". ",e]})},a))})]}),t&&(0,v.jsx)("div",{className:"mt-3",children:(0,v.jsxs)(l.Fc,{color:0===t.errors.length?"success":"warning",children:[(0,v.jsx)("h6",{children:"Resultado do Upload:"}),(0,v.jsxs)("p",{className:"mb-1",children:[(0,v.jsx)("strong",{children:"Sucessos:"})," ",t.success]}),t.errors.length>0&&(0,v.jsxs)("div",{children:[(0,v.jsxs)("strong",{children:["Erros (",t.errors.length,"):"]}),(0,v.jsx)("div",{className:"mt-2",style:{maxHeight:"150px",overflowY:"auto",fontSize:"0.875rem"},children:t.errors.map((e,a)=>(0,v.jsx)("div",{className:"text-danger",children:e},a))})]})]})})]}),(0,v.jsxs)(l.jl,{children:[(0,v.jsx)(l.$n,{color:"secondary",onClick:n,children:"Cancelar"}),(0,v.jsxs)(l.$n,{color:"success",onClick:c,disabled:0===r.length||o,children:[o?(0,v.jsx)(l.y$,{size:"sm",className:"me-2"}):null,o?"Processando...":"Cadastrar ".concat(r.length," Premia\xe7\xf5es")]})]})]})};var z=n(96690);const F=e=>e.producer?{id:e.producer.id,uuid:e.producer.uuid,full_name:e.producer.full_name,email:e.producer.email,phone:e.producer.phone}:{id:e.id,uuid:e.uuid||"",full_name:e.full_name,email:e.email,phone:e.phone},R=e=>new Date(e).toLocaleDateString("pt-BR"),U=()=>{const{skin:e}=(0,h.h)(),[a,n]=(0,r.useState)({calendar:[]}),[i,p]=(0,r.useState)([]),[j,C]=(0,r.useState)("10K"),[N,w]=(0,r.useState)("pending"),[_,b]=(0,r.useState)(!1),[E,P]=(0,r.useState)(null),[U,$]=(0,r.useState)({}),[M,L]=(0,r.useState)(10),[q,O]=(0,r.useState)(0),[B,Y]=(0,r.useState)(0),[I,J]=(0,r.useState)(!1),[V,Q]=(0,r.useState)({producer_uuid:"",producer_email:"",tracking_code:"",tracking_link:"",status:"pending"}),[K,H]=(0,r.useState)(!1),[W,Z]=(0,r.useState)(null),[G,X]=(0,r.useState)(!1),[ee,ae]=(0,r.useState)({milestone:"",achieved_date:"",tracking_code:"",tracking_link:"",status:"pending",sent_date:""}),[ne,se]=(0,r.useState)(!1),[re,le]=(0,r.useState)([]),[te,oe]=(0,r.useState)(!1),[ie,ce]=(0,r.useState)(null),[de,me]=(0,r.useState)(""),[ue,he]=(0,r.useState)(""),[xe,ge]=(0,r.useState)(!1),[pe,je]=(0,r.useState)(null),[ve,fe]=(0,r.useState)(!1),ke=e=>{const a=(e||"").trim();return""===a?null:a},Ce=async()=>{b(!0),P(null);try{const e=j,a={milestone:e,status:"pending",page:q,size:M},n={milestone:e,status:"sent",page:B,size:M};if(null!==ue&&void 0!==ue&&ue.trim()&&(a.input=ue.trim(),n.input=ue.trim()),i&&2===i.length&&i[0]&&i[1]&&c()(i[0]).isValid()&&c()(i[1]).isValid()){const e=c()(i[0]).format("YYYY-MM-DD"),s=c()(i[1]).format("YYYY-MM-DD");a.start_date=e,a.end_date=s,n.start_date=e,n.end_date=s}const[r,l]=await Promise.all([d.F.get("/award-shipments",{params:a}),d.F.get("/award-shipments",{params:n})]);$(a=>(0,s.A)((0,s.A)({},a),{},{[e]:{pending:r.data.rows||[],sent:l.data.rows||[],pendingCount:r.data.count||0,sentCount:l.data.count||0}}))}catch(e){P("Erro ao carregar dados das premia\xe7\xf5es. Tente novamente."),console.error("Erro ao carregar premia\xe7\xf5es:",e)}finally{b(!1)}};(0,r.useEffect)(()=>{const e=setTimeout(()=>{he(de)},500);return()=>clearTimeout(e)},[de]),(0,r.useEffect)(()=>{const e=setTimeout(()=>{a.calendar&&2===a.calendar.length&&a.calendar[0]&&a.calendar[1]&&c()(a.calendar[0]).isValid()&&c()(a.calendar[1]).isValid()?p(a.calendar):p([])},500);return()=>clearTimeout(e)},[a.calendar]),(0,r.useEffect)(()=>{Ce()},[j,q,B,ue,i]);const Ne=U[j]||{pending:[],sent:[],pendingCount:0,sentCount:0},we=Ne.pending,_e=Ne.sent,ye=Ne.pendingCount||0,be=Ne.sentCount||0,Ae=e=>{Z(e),ae({milestone:e.milestone,achieved_date:e.achieved_date.split("T")[0],tracking_code:e.tracking_code||"",tracking_link:e.tracking_link||"",status:e.status,sent_date:e.sent_date?e.sent_date.split("T")[0]:""}),H(!0)},Se=()=>{ae({milestone:"",achieved_date:"",tracking_code:"",tracking_link:"",status:"pending",sent_date:""}),Z(null),P(null)},Ee=()=>{le([]),ce(null),P(null)};return(0,v.jsxs)("div",{children:[(0,v.jsx)(f,{onUploadClick:()=>se(!0),onCreateClick:()=>J(!0)}),E&&(0,v.jsxs)(l.Fc,{color:"danger",className:"mb-4",children:[(0,v.jsx)(o.A,{size:16,className:"me-2"}),E]}),(0,v.jsx)(k,{milestones:["10K","50K","500K","1M","5M","10M"],selectedMilestone:j,onMilestoneChange:e=>{C(e),O(0),Y(0)}}),(0,v.jsx)(l.Zp,{children:(0,v.jsxs)(l.bw,{children:[(0,v.jsx)(y,{activeTab:N,onTabChange:w,pendingTotal:ye,sentTotal:be,filter:a,onDateChange:e=>{n(a=>(0,s.A)((0,s.A)({},a),{},{calendar:e})),e&&2===e.length&&e[0]&&e[1]&&c()(e[0]).isValid()&&c()(e[1]).isValid()&&(O(0),Y(0))},onQuickRange:e=>{const a=new Date,r=new Date;r.setDate(a.getDate()-(e-1)),n(e=>(0,s.A)((0,s.A)({},e),{},{calendar:[r,a]})),O(0),Y(0)},onClearFilter:()=>n(e=>(0,s.A)((0,s.A)({},e),{},{calendar:[]})),searchText:de,onSearchChange:e=>{me(e),O(0),Y(0)}}),(0,v.jsx)(A,{activeTab:N,pendingProducers:we,sentProducers:_e,pendingTotal:ye,sentTotal:be,loading:_,skin:e,pendingColumns:(0,x.A)(()=>(e=>[{name:"Produtor",cell:e=>{const a=F(e);return(0,v.jsx)("div",{className:"text-capitalize",children:a.uuid?(0,v.jsx)(z.N_,{to:"/producer/".concat(a.uuid),className:"text-primary text-decoration-none",style:{cursor:"pointer"},children:(0,v.jsx)("strong",{children:a.full_name})}):(0,v.jsx)("strong",{children:a.full_name})})}},{name:"Email",cell:e=>{const a=F(e);return(0,v.jsx)("a",{href:"mailto:".concat(a.email),className:"text-info text-decoration-none",style:{cursor:"pointer"},children:(0,v.jsx)("small",{children:a.email})})}},{name:"Telefone",cell:e=>{const a=F(e);return(0,v.jsx)("a",{href:"https://wa.me/55".concat(a.phone.replace(/\D/g,"")),target:"_blank",rel:"noopener noreferrer",className:"text-success text-decoration-none",style:{cursor:"pointer"},children:(0,v.jsx)("small",{children:a.phone})})}},{name:"Faturamento",cell:e=>(0,v.jsx)("span",{className:"fw-bold",children:(0,g.cC)(e.user_total_comission||0)})},{name:"Data Alcan\xe7ada",cell:e=>(0,v.jsx)("small",{children:R(e.achieved_date)})},{name:"Status",cell:e=>(0,v.jsx)(l.Ex,{color:"warning",pill:!0,children:"Pendente"})},{name:"A\xe7\xf5es",center:!0,cell:a=>(0,v.jsx)(l.Ex,{color:"primary",size:"sm",onClick:()=>e(a),style:{cursor:"pointer"},className:"d-flex align-items-center",children:(0,v.jsx)(t.A,{size:20})})}])(Ae))(),sentColumns:(0,x.A)(()=>(e=>[{name:"Produtor",cell:e=>{const a=F(e);return(0,v.jsx)("div",{className:"text-capitalize",children:a.uuid?(0,v.jsx)(z.N_,{to:"/producer/".concat(a.uuid),className:"text-primary text-decoration-none",style:{cursor:"pointer"},children:(0,v.jsx)("strong",{children:a.full_name})}):(0,v.jsx)("strong",{children:a.full_name})})},width:"15%"},{name:"Email",cell:e=>{const a=F(e);return(0,v.jsx)("a",{href:"mailto:".concat(a.email),className:"text-info text-decoration-none",style:{cursor:"pointer"},children:(0,v.jsx)("small",{children:a.email})})},width:"15%"},{name:"Telefone",cell:e=>{const a=F(e);return(0,v.jsx)("a",{href:"https://wa.me/55".concat(a.phone.replace(/\D/g,"")),target:"_blank",rel:"noopener noreferrer",className:"text-success text-decoration-none",style:{cursor:"pointer"},children:(0,v.jsx)("small",{children:a.phone})})},width:"15%"},{name:"Data Alcan\xe7ada",cell:e=>(0,v.jsx)("small",{children:R(e.achieved_date)}),width:"10%"},{name:"Data Enviado",cell:e=>(0,v.jsx)("small",{children:e.sent_date&&R(e.sent_date)}),width:"10%"},{name:"Rastreamento",cell:e=>{var a;return(0,v.jsx)("div",{className:"d-flex flex-column",children:(0,v.jsx)("small",{className:"mb-1",children:null!==(a=e.tracking_code)&&void 0!==a&&a.trim()?(0,v.jsx)("a",{href:e.tracking_link,target:"_blank",rel:"noopener noreferrer",className:"text-decoration-none",children:(0,v.jsx)("small",{className:"text-primary",children:e.tracking_code})}):(0,v.jsx)("small",{children:"-"})})})},width:"15%"},{name:"Status",cell:e=>(0,v.jsx)(l.Ex,{color:"success",pill:!0,children:"Enviado"}),width:"10%"},{name:"A\xe7\xf5es",center:!0,cell:a=>(0,v.jsx)(l.Ex,{color:"primary",size:"sm",onClick:()=>e(a),style:{cursor:"pointer"},className:"d-flex align-items-center",children:(0,v.jsx)(t.A,{size:20})}),width:"5%"}])(Ae))(),onPendingPageChange:e=>{O(e-1)},onPendingRowsPerPageChange:(e,a)=>{L(e),O(a-1)},onSentPageChange:e=>{Y(e-1)},onSentRowsPerPageChange:(e,a)=>{L(e),Y(a-1)}})]})}),(0,v.jsx)(S,{isOpen:I,onToggle:()=>{J(!1),Q({producer_uuid:"",producer_email:"",tracking_code:"",tracking_link:"",status:"pending"}),P(null)},selectedMilestone:j,createForm:V,onFormChange:(e,a)=>Q((0,s.A)((0,s.A)({},V),{},{[e]:a})),onCreateAward:async()=>{if(V.producer_uuid.trim()||V.producer_email.trim()){b(!0),P(null);try{const e=new Date,a=ke(V.tracking_code),n=ke(V.tracking_link),r=a&&n?"sent":"pending",l="sent"===r?e:void 0,t=(0,s.A)((0,s.A)((0,s.A)({},V.producer_uuid.trim()&&{producer_uuid:V.producer_uuid.trim()}),V.producer_email.trim()&&{producer_email:V.producer_email.trim()}),{},{milestone:j,achieved_date:e,status:r,sent_date:l});null!==a&&(t.tracking_code=a),null!==n&&(t.tracking_link=n),await d.F.post("/award-shipments",t),await Ce(),J(!1),Q({producer_uuid:"",producer_email:"",tracking_code:"",tracking_link:"",status:"pending"}),P(null)}catch(r){var e,a,n;console.error("Erro completo:",(null===(e=r.response)||void 0===e?void 0:e.data)||r.message),P("Erro ao criar premia\xe7\xe3o: ".concat((null===(a=r.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||r.message))}finally{b(!1)}}else P("UUID ou email do produtor \xe9 obrigat\xf3rio.")},loading:_}),(0,v.jsx)(D,{isOpen:K,onToggle:()=>{H(!1),Se()},editingProducer:W,editForm:ee,onFormChange:(e,a)=>ae((0,s.A)((0,s.A)({},ee),{},{[e]:a})),onUpdateAward:async()=>{if(W){b(!0),P(null);try{const e=ke(ee.tracking_code),a=ke(ee.tracking_link);if("pending"===W.status){const n={};null!==e&&(n.tracking_code=e),null!==a&&(n.tracking_link=a),await d.F.patch("/award-shipments/".concat(W.id,"/confirm"),n)}else{const n={};null!==e&&(n.tracking_code=e),null!==a&&(n.tracking_link=a),await d.F.patch("/award-shipments/".concat(W.id),n)}await Ce(),H(!1),Z(null),P(null)}catch(s){var e,a,n;console.error("Erro ao processar premia\xe7\xe3o:",(null===(e=s.response)||void 0===e?void 0:e.data)||s.message),P("Erro ao processar premia\xe7\xe3o: ".concat((null===(a=s.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||s.message))}finally{b(!1)}}},onDeleteAward:()=>W&&(je(W),void ge(!0)),onBlockAward:()=>fe(!0),blocking:G,loading:_,getProducerData:F}),pe&&(0,v.jsx)(m.A,{show:xe,setShow:ge,footer:!1,centered:!0,simpleConfirm:!0,title:"Confirmar exclus\xe3o",description:"Tem certeza que deseja excluir a premia\xe7\xe3o de ".concat(F(pe).full_name,"?"),textAlert:"Essa opera\xe7\xe3o n\xe3o poder\xe1 ser desfeita.",buttonText:"Excluir",handleAction:async()=>{pe&&(await(async e=>{b(!0),P(null);try{await d.F.delete("/award-shipments/".concat(e.id)),await Ce(),K&&(H(!1),Se()),P(null)}catch(r){var a,n,s;console.error("Erro ao excluir premia\xe7\xe3o:",(null===(a=r.response)||void 0===a?void 0:a.data)||r.message),P("Erro ao excluir premia\xe7\xe3o: ".concat((null===(n=r.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message)||r.message))}finally{b(!1)}})(pe),ge(!1),je(null))}}),W&&(0,v.jsx)(m.A,{show:ve,setShow:fe,footer:!1,centered:!0,simpleConfirm:!0,title:"Confirmar bloqueio",description:"Tem certeza que deseja bloquear ".concat(F(W).full_name," para premia\xe7\xf5es? Ele n\xe3o poder\xe1 mais receber novas premia\xe7\xf5es. Para desbloquear, acesse a aba do produtor."),buttonText:"Bloquear",handleAction:async()=>{await(async()=>{if(!W)return;const e=F(W);X(!0),P(null);try{if(!e.uuid)throw new Error("UUID do produtor n\xe3o encontrado para bloqueio.");await d.F.patch("/users/".concat(e.uuid,"/awards/block")),await Ce(),H(!1),Z(null)}catch(r){var a,n,s;console.error("Erro ao bloquear produtor:",(null===(a=r.response)||void 0===a?void 0:a.data)||r.message),P("Erro ao bloquear produtor: ".concat((null===(n=r.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message)||r.message))}finally{X(!1)}})(),fe(!1)}}),(0,v.jsx)(T,{isOpen:ne,onToggle:()=>{se(!1),Ee()},selectedMilestone:j,uploadEmails:re,uploadResults:ie,uploadLoading:te,onFileChange:e=>{(e=>{const a=new FileReader;a.onload=e=>{try{var a;const n=new Uint8Array(null===(a=e.target)||void 0===a?void 0:a.result),s=u.read(n,{type:"array"}),r=s.SheetNames[0],l=s.Sheets[r],t=u.utils.sheet_to_json(l,{header:1}),o=[];t.forEach(e=>{e[0]&&"string"===typeof e[0]&&e[0].includes("@")&&o.push(e[0].trim())}),le(o),P(null)}catch(n){P("Erro ao processar arquivo Excel. Verifique o formato."),console.error("Erro ao processar Excel:",n)}},a.readAsArrayBuffer(e)})(e)},onBulkUpload:async()=>{if(0!==re.length){oe(!0),P(null),ce(null);try{const s={success:0,errors:[]};for(const r of re)try{const e=new Date,a={producer_email:r,milestone:j,achieved_date:e,status:"pending"};await d.F.post("/award-shipments",a),s.success++}catch(n){var e,a;const l=(null===(e=n.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||n.message||"Erro desconhecido";s.errors.push("".concat(r,": ").concat(l))}ce(s),s.success>0&&await Ce(),0===s.errors.length&&setTimeout(()=>{se(!1),Ee()},2e3)}catch(n){P("Erro ao processar upload em lote. Tente novamente."),console.error("Erro no upload em lote:",n)}finally{oe(!1)}}else P("Nenhum email v\xe1lido encontrado no arquivo.")}})]})}},94300:()=>{}}]);