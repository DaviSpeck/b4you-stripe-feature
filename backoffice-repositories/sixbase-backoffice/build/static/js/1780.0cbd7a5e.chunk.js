"use strict";(self.webpackChunksixbase_backoffice=self.webpackChunksixbase_backoffice||[]).push([[1780],{42846:(e,s,l)=>{l.r(s),l.d(s,{default:()=>W});var a=l(9950),i=l(35203),t=l(58751),n=l(89379),r=l(24113),o=l(26473),c=l(60666),d=l(34964),u=(l(94300),l(45530));const m=()=>u.F.get("/notifications").then(e=>e.data),h=e=>u.F.post("/notifications/send-push-notification",e).then(e=>e.data),x=e=>u.F.delete("/notifications/".concat(e)).then(()=>e);var g=l(48738),j=l.n(g),p=l(26548);const f=l.p+"static/media/b4you-logo-app.abed4edcb479e50a7b20.png";var v=l(44414);function b(e){let{title:s,content:l,url:t,image:n}=e;const[r,o]=(0,a.useState)("compact"),c=e=>{r!==e&&o(e)};return(0,v.jsxs)("div",{className:"notification-preview",children:[(0,v.jsxs)(i.so,{tabs:!0,children:[(0,v.jsx)(i.CI,{children:(0,v.jsx)(i.k2,{className:j()({active:"compact"===r}),onClick:()=>c("compact"),children:"Visualiza\xe7\xe3o Reduzida"})}),(0,v.jsx)(i.CI,{children:(0,v.jsx)(i.k2,{className:j()({active:"expanded"===r}),onClick:()=>c("expanded"),children:"Visualiza\xe7\xe3o Ampliada"})})]}),(0,v.jsx)(i.JS,{activeTab:r,className:"mt-2",children:(0,v.jsx)(i.mF,{tabId:r,children:(()=>{switch(r){case"compact":return(0,v.jsxs)("div",{className:"preview compact",children:[(0,v.jsx)("img",{src:f,alt:"app",className:"app-icon"}),(0,v.jsxs)("div",{className:"text",children:[(0,v.jsx)("strong",{children:s||"T\xedtulo"}),(0,v.jsx)("small",{className:"subtitle",children:"de B4You"}),(0,v.jsx)("p",{children:l||"Conte\xfado da notifica\xe7\xe3o"})]}),(0,v.jsx)("span",{className:"time",children:"agora"})]});case"expanded":return(0,v.jsxs)("div",{className:"preview expanded",children:[n&&(0,v.jsx)("img",{className:"hero",src:n,alt:"notification"}),(0,v.jsxs)("div",{className:"header",children:[(0,v.jsx)(p.A,{size:14,className:"me-50"}),(0,v.jsx)("span",{children:"Google Chrome \xb7 sandbox-dash.b4you.com.br"})]}),(0,v.jsxs)("div",{className:"body",children:[(0,v.jsx)("img",{src:f,alt:"B4You",className:"app-icon"}),(0,v.jsxs)("div",{className:"text",children:[(0,v.jsx)("strong",{children:s||"T\xedtulo"}),(0,v.jsx)("p",{children:l||"Conte\xfado da notifica\xe7\xe3o"}),t&&(0,v.jsx)("small",{className:"url",children:t})]})]})]});default:return null}})()})})]})}const _=e=>{let{isOpen:s,onToggle:l,basePayload:t,onSendTest:n,loading:r,results:o}=e;const[c,d]=(0,a.useState)("");return(0,v.jsxs)(i.aF,{isOpen:s,toggle:l,centered:!0,children:[(0,v.jsx)(i.rQ,{toggle:l,children:"Testar Notifica\xe7\xe3o"}),(0,v.jsxs)(i.cw,{children:[(0,v.jsxs)(i.gE,{children:[(0,v.jsx)(i.JU,{for:"emails",children:"Lista de E-mails (separados por v\xedrgula)"}),(0,v.jsx)(i.pd,{type:"textarea",id:"emails",rows:4,placeholder:"exemplo@teste.com, outro@teste.com",value:c,onChange:e=>d(e.target.value)})]}),o&&(0,v.jsxs)(i.Fc,{color:0===o.errors.length?"success":"warning",children:[(0,v.jsx)("h6",{children:"Resultado:"}),(0,v.jsxs)("p",{children:[(0,v.jsx)("strong",{children:"Sucessos:"})," ",o.success]}),o.errors.length>0&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("strong",{children:"Erros:"}),(0,v.jsx)("ul",{children:o.errors.map((e,s)=>(0,v.jsx)("li",{children:e},s))})]})]})]}),(0,v.jsxs)(i.jl,{children:[(0,v.jsx)(i.$n,{color:"secondary",onClick:l,children:"Cancelar"}),(0,v.jsxs)(i.$n,{color:"primary",disabled:r,onClick:async()=>{const e=c.split(",").map(e=>e.trim()).filter(e=>!!e&&e.includes("@"));0!==e.length&&await n(e)},children:[r?(0,v.jsx)(i.y$,{size:"sm",className:"me-1"}):null,r?"Enviando...":"Enviar Teste"]})]})]})},y=e=>{var s,l,a;let{isOpen:t,onToggle:n,basePayload:r,onConfirm:o,loading:c}=e;const{title:d,content:u,platforms:m,audience:h,url:x,image_url:g}=r||{};return(0,v.jsxs)(i.aF,{isOpen:t,toggle:n,centered:!0,size:"lg",children:[(0,v.jsx)(i.rQ,{toggle:n,children:"Confirmar envio"}),(0,v.jsxs)(i.cw,{children:[(0,v.jsxs)("div",{className:"mb-2",children:[(0,v.jsxs)("p",{children:[(0,v.jsx)("strong",{children:"T\xedtulo:"})," ",d||"-"]}),(0,v.jsxs)("p",{children:[(0,v.jsx)("strong",{children:"Conte\xfado:"})," ",u||"-"]}),(0,v.jsxs)("div",{className:"mb-2",children:[(0,v.jsx)("p",{children:(0,v.jsx)("strong",{children:"Plataformas:"})}),null!==m&&void 0!==m&&m.length?m.map(e=>(0,v.jsx)(i.Ex,{color:"web"===e?"info":"success",className:"me-50",children:"web"===e?"Web":"Mobile"},e)):(0,v.jsx)("span",{children:"-"}),(null===h||void 0===h||null===(s=h.tags)||void 0===s?void 0:s.length)>0&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("p",{className:"mt-1",children:(0,v.jsx)("strong",{children:"Tags:"})}),h.tags.map(e=>{const s="producer_status"===e?"Produtores":"affiliate_status"===e?"Creators/Afiliados":"user_status"===e?"Usu\xe1rios Inativos":e;return(0,v.jsx)(i.Ex,{color:"secondary",className:"me-50",children:s},e)})]})]}),(null===h||void 0===h||null===(l=h.subscription_ids)||void 0===l?void 0:l.length)>0&&(0,v.jsxs)("p",{children:[(0,v.jsx)("strong",{children:"Subscription IDs:"})," ",h.subscription_ids.join(", ")]}),(null===h||void 0===h||null===(a=h.external_user_ids)||void 0===a?void 0:a.length)>0&&(0,v.jsxs)("p",{children:[(0,v.jsx)("strong",{children:"External User IDs:"})," ",h.external_user_ids.join(", ")]})]}),(0,v.jsx)("h6",{className:"mb-1",children:"Pr\xe9-visualiza\xe7\xe3o"}),(0,v.jsx)(b,{title:d,content:u,url:x,image:g}),(0,v.jsxs)(i.Fc,{color:"warning",className:"mt-3",children:["\u26a0\ufe0f Todos os usu\xe1rios com essa configura\xe7\xe3o receber\xe3o a notifica\xe7\xe3o"," ",(0,v.jsx)("strong",{children:null!==m&&void 0!==m&&m.includes("web")&&null!==m&&void 0!==m&&m.includes("mobile")?"APP e WEB":null!==m&&void 0!==m&&m.includes("web")?"WEB":"APP"}),".",(0,v.jsx)("br",{}),"\ud83d\udc49 Recomendamos ",(0,v.jsx)("strong",{children:"testar primeiro"})," antes de salvar definitivo."]})]}),(0,v.jsxs)(i.jl,{children:[(0,v.jsx)(i.$n,{color:"secondary",onClick:n,disabled:c,children:"Cancelar"}),(0,v.jsx)(i.$n,{color:"success",onClick:o,disabled:c,children:c?"Enviando...":"Confirmar envio"})]})]})},N=(e,s)=>{if(Array.isArray(s)||void 0===s)return e;if("string"===typeof s){const e=(s||"").split(",").map(e=>e.trim()).filter(Boolean);return e.length?e:void 0}},w=c.Ik({title:c.Yj().required("\xc9 preciso informar um t\xedtulo").max(80,"M\xe1ximo de 80 caracteres"),content:c.Yj().required("\xc9 preciso informar um conte\xfado").max(200,"M\xe1ximo de 200 caracteres"),url:c.Yj().url("Deve ser uma URL v\xe1lida").notRequired(),image_url:c.Yj().url("Deve ser uma URL de imagem v\xe1lida").notRequired(),platforms:c.YO().of(c.Yj().oneOf(["web","mobile"])).min(1,"Selecione ao menos uma plataforma").required("Selecione ao menos uma plataforma"),audience:c.Ik({tags:c.YO().of(c.Yj().oneOf(["producer_status","affiliate_status","user_status"])).notRequired(),subscription_ids:c.YO().transform(N).of(c.Yj().uuid("Cada subscription_id deve ser UUID v\xe1lido")).notRequired(),external_user_ids:c.YO().transform(N).of(c.Yj()).notRequired()}).test("audience-exclusive","Use apenas um de: tags, subscription_ids ou external_user_ids",e=>{var s,l,a;return[(null===(s=e.tags)||void 0===s?void 0:s.length)>0,(null===(l=e.subscription_ids)||void 0===l?void 0:l.length)>0,(null===(a=e.external_user_ids)||void 0===a?void 0:a.length)>0].filter(Boolean).length<=1}).default({tags:[]}),schedule:c.Ik({type:c.Yj().oneOf(["immediate","scheduled","relative"]).required("Type \xe9 obrigat\xf3rio"),send_at:c.p6().when("type",{is:"scheduled",then:e=>e.required("send_at \xe9 obrigat\xf3rio para scheduled").min(new Date,"N\xe3o pode agendar no passado"),otherwise:e=>e.strip()}),offset_in_minutes:c.ai().integer().when("type",{is:"relative",then:e=>e.required("offset_in_minutes \xe9 obrigat\xf3rio para relative"),otherwise:e=>e.strip()})}).required("schedule \xe9 obrigat\xf3rio")}).required(),k={title:"",content:"",url:"",image_url:"",platforms:[],audience:{tags:[],subscription_ids:"",external_user_ids:""},schedule:{type:"immediate",send_at:null,offset_in_minutes:""}};function C(e){var s,l,t;let{onSuccess:c,onCancel:m}=e;const{control:x,handleSubmit:g,formState:{errors:j,isValid:p},getValues:f}=(0,r.mN)({mode:"onChange",resolver:(0,o.t)(w),defaultValues:k}),N=(0,r.FH)({control:x,name:"title"}),C=(0,r.FH)({control:x,name:"content"}),A=(0,r.FH)({control:x,name:"url"}),S=(0,r.FH)({control:x,name:"image_url"}),E=(0,r.FH)({control:x,name:"schedule.type"}),[I,T]=(0,a.useState)(!1),[F,U]=(0,a.useState)(!1),[Y,P]=(0,a.useState)(!1),[O,R]=(0,a.useState)(!1),[D,L]=(0,a.useState)(null);return(0,v.jsxs)(i.lV,{className:"notification-form",onSubmit:g(()=>{U(!0)}),children:[(0,v.jsxs)(i.gE,{className:"mb-1",children:[(0,v.jsx)(i.JU,{for:"title",children:"T\xedtulo *"}),(0,v.jsx)(r.xI,{name:"title",control:x,render:e=>{let{field:s}=e;return(0,v.jsx)(i.pd,(0,n.A)((0,n.A)({},s),{},{id:"title",placeholder:"Digite o t\xedtulo",maxLength:80,invalid:!!j.title}))}}),(0,v.jsxs)("small",{className:"text-muted",children:[(null===N||void 0===N?void 0:N.length)||0,"/80 caracteres"]}),j.title&&(0,v.jsx)(i.yY,{children:j.title.message})]}),(0,v.jsxs)(i.gE,{children:[(0,v.jsx)(i.JU,{for:"content",children:"Conte\xfado *"}),(0,v.jsx)(r.xI,{name:"content",control:x,render:e=>{let{field:s}=e;return(0,v.jsx)(i.pd,(0,n.A)((0,n.A)({},s),{},{type:"textarea",id:"content",rows:"4",placeholder:"Digite o conte\xfado",maxLength:200,invalid:!!j.content}))}}),(0,v.jsxs)("small",{className:"text-muted",children:[(null===C||void 0===C?void 0:C.length)||0,"/200 caracteres"]}),j.content&&(0,v.jsx)(i.yY,{children:j.content.message})]}),(0,v.jsxs)(i.gE,{children:[(0,v.jsx)(i.JU,{for:"url",children:"URL (clic\xe1vel)"}),(0,v.jsx)(r.xI,{name:"url",control:x,render:e=>{let{field:s}=e;return(0,v.jsx)(i.pd,(0,n.A)((0,n.A)({},s),{},{type:"url",id:"url",placeholder:"https://seu.site/exemplo",invalid:!!j.url}))}}),j.url&&(0,v.jsx)(i.yY,{children:j.url.message})]}),(0,v.jsxs)(i.gE,{children:[(0,v.jsx)(i.JU,{for:"image_url",children:"URL da Imagem"}),(0,v.jsx)(r.xI,{name:"image_url",control:x,render:e=>{let{field:s}=e;return(0,v.jsx)(i.pd,(0,n.A)((0,n.A)({},s),{},{type:"url",id:"image_url",placeholder:"https://seu.site/imagem.jpg",invalid:!!j.image_url}))}}),j.image_url&&(0,v.jsx)(i.yY,{children:j.image_url.message})]}),(0,v.jsxs)(i.fI,{children:[(0,v.jsx)(i.fv,{md:"12",children:(0,v.jsxs)(i.gE,{tag:"fieldset",children:[(0,v.jsx)(i.JU,{className:"d-block mb-50",children:"Filtros por Tag"}),(0,v.jsx)(r.xI,{name:"audience.tags",control:x,render:e=>{let{field:s}=e;return(0,v.jsx)(v.Fragment,{children:[{label:"Produtores",value:"producer_status"},{label:"Creators/Afiliados",value:"affiliate_status"},{label:"Usu\xe1rios Inativos",value:"user_status"}].map(e=>(0,v.jsxs)(i.gE,{check:!0,inline:!0,children:[(0,v.jsx)(i.pd,(0,n.A)((0,n.A)({},s),{},{type:"checkbox",id:"tag-".concat(e.value),value:e.value,checked:s.value.includes(e.value),onChange:l=>{const a=l.target.checked?[...s.value,e.value]:s.value.filter(s=>s!==e.value);s.onChange(a)}})),(0,v.jsx)(i.JU,{check:!0,for:"tag-".concat(e.value),children:e.label})]},e.value))})}}),(null===(s=j.audience)||void 0===s?void 0:s.tags)&&(0,v.jsx)(i.yY,{className:"d-block",children:j.audience.tags.message})]})}),(0,v.jsx)(i.fv,{md:"12",children:(0,v.jsxs)(i.gE,{tag:"fieldset",children:[(0,v.jsx)(i.JU,{className:"d-block mb-50",children:"Plataforma *"}),(0,v.jsx)(r.xI,{name:"platforms",control:x,render:e=>{let{field:s}=e;return(0,v.jsx)(v.Fragment,{children:[{label:"Web",value:"web"},{label:"Mobile",value:"mobile"}].map(e=>(0,v.jsxs)(i.gE,{check:!0,inline:!0,children:[(0,v.jsx)(i.pd,(0,n.A)((0,n.A)({},s),{},{type:"checkbox",id:"platform-".concat(e.value),value:e.value,checked:s.value.includes(e.value),onChange:l=>{const a=l.target.checked?[...s.value,e.value]:s.value.filter(s=>s!==e.value);s.onChange(a)}})),(0,v.jsx)(i.JU,{check:!0,for:"platform-".concat(e.value),children:e.label})]},e.value))})}}),j.platforms&&(0,v.jsx)(i.yY,{className:"d-block",children:j.platforms.message})]})})]}),(0,v.jsxs)(i.gE,{tag:"fieldset",children:[(0,v.jsx)(i.JU,{className:"d-block mb-50",children:"Agendamento"}),(0,v.jsx)(r.xI,{name:"schedule.type",control:x,render:e=>{let{field:s}=e;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(i.gE,{check:!0,inline:!0,children:[(0,v.jsx)(i.pd,(0,n.A)((0,n.A)({},s),{},{type:"radio",id:"sched-immediate",value:"immediate",checked:"immediate"===s.value})),(0,v.jsx)(i.JU,{check:!0,for:"sched-immediate",children:"Imediato"})]}),(0,v.jsxs)(i.gE,{check:!0,inline:!0,children:[(0,v.jsx)(i.pd,(0,n.A)((0,n.A)({},s),{},{type:"radio",id:"sched-scheduled",value:"scheduled",checked:"scheduled"===s.value})),(0,v.jsx)(i.JU,{check:!0,for:"sched-scheduled",children:"Data/hora exata"})]}),(0,v.jsxs)(i.gE,{check:!0,inline:!0,children:[(0,v.jsx)(i.pd,(0,n.A)((0,n.A)({},s),{},{type:"radio",id:"sched-relative",value:"relative",checked:"relative"===s.value})),(0,v.jsx)(i.JU,{check:!0,for:"sched-relative",children:"Daqui a ... minutos"})]})]})}})]}),"scheduled"===E&&(0,v.jsxs)(i.gE,{children:[(0,v.jsx)(i.JU,{for:"send_at",children:"Data/hora de envio *"}),(0,v.jsx)(r.xI,{name:"schedule.send_at",control:x,render:e=>{var s;let{field:l}=e;return(0,v.jsx)(d.A,(0,n.A)((0,n.A)({},l),{},{id:"send_at",className:"form-control ".concat(null!==(s=j.schedule)&&void 0!==s&&s.send_at?"is-invalid":""),options:{enableTime:!0,dateFormat:"d/m/Y H:i"},placeholder:"Escolha a data/hora"}))}}),(null===(l=j.schedule)||void 0===l?void 0:l.send_at)&&(0,v.jsx)(i.yY,{className:"d-block",children:j.schedule.send_at.message})]}),"relative"===E&&(0,v.jsxs)(i.gE,{children:[(0,v.jsx)(i.JU,{for:"offset",children:"Minutos a partir de agora *"}),(0,v.jsx)(r.xI,{name:"schedule.offset_in_minutes",control:x,render:e=>{var s;let{field:l}=e;return(0,v.jsx)(i.pd,(0,n.A)((0,n.A)({},l),{},{id:"offset",type:"number",min:"1",invalid:!(null===(s=j.schedule)||void 0===s||!s.offset_in_minutes)}))}}),(null===(t=j.schedule)||void 0===t?void 0:t.offset_in_minutes)&&(0,v.jsx)(i.yY,{children:j.schedule.offset_in_minutes.message})]}),(0,v.jsx)("h5",{className:"mt-1 mb-1",children:"Pr\xe9-visualiza\xe7\xe3o"}),(0,v.jsx)(b,{title:N,content:C,url:A,image:S}),(0,v.jsxs)("div",{className:"form-buttons d-flex justify-content-end mt-2",children:[(0,v.jsx)(i.$n,{color:"secondary",className:"me-1",onClick:m,children:"Cancelar"}),(0,v.jsx)(i.$n,{type:"submit",color:"success",className:"me-1",children:"Salvar"}),(0,v.jsx)(i.$n,{type:"button",color:"info",onClick:()=>T(!0),disabled:!p,children:"Testar Notifica\xe7\xe3o"})]}),(0,v.jsx)(_,{isOpen:I,onToggle:()=>T(!1),basePayload:f(),onSendTest:async e=>{R(!0),L(null);try{const s=(await u.F.post("/notifications/resolve-emails",{emails:e})).data.uuids||[];if(!s.length)return void L({success:0,errors:["Nenhum usu\xe1rio encontrado para os e-mails fornecidos"]});const l=f(),a=(0,n.A)((0,n.A)({title:l.title,content:l.content,platforms:l.platforms,schedule:{type:"immediate"},audience:{external_user_ids:s}},l.url?{url:l.url}:{}),l.image_url?{image_url:l.image_url}:{}),i=await u.F.post("/notifications/test-push-notification",a);L({success:i.data.success,errors:i.data.errors||[]})}catch(a){var s,l;L({success:0,errors:[(null===(s=a.response)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.message)||a.message]})}finally{R(!1)}},loading:O,results:D}),(0,v.jsx)(y,{isOpen:F,onToggle:()=>U(!1),basePayload:f(),onConfirm:async()=>{var e;const s=f(),{title:l,content:a,audience:i,schedule:t}=s,r={subscription_ids:i.subscription_ids,external_user_ids:i.external_user_ids,tags:null!==(e=i.tags)&&void 0!==e&&e.length?i.tags:void 0},o=(0,n.A)((0,n.A)({title:l,content:a,platforms:s.platforms,audience:r,schedule:(0,n.A)({},t)},s.url?{url:s.url}:{}),s.image_url?{image_url:s.image_url}:{});"scheduled"!==t.type&&delete o.schedule.send_at,"relative"!==t.type&&delete o.schedule.offset_in_minutes;try{P(!0),await h(o),null===c||void 0===c||c()}finally{P(!1),U(!1)}},loading:Y})]})}var A=l(30639),S=l(96341),E=l(32220),I=l(81614);const T=e=>e?new Date(e).toLocaleString("pt-BR",{dateStyle:"short",timeStyle:"short"}):"\u2014",F=e=>{switch(e){case"push":return"\ud83d\udcbb Push";case"email":return"\u2709\ufe0f E\u2011mail";case"sms":return"\ud83d\udcf1 SMS";default:return"\u2014"}},U=e=>{switch(e){case"user_status":return"Inativo";case"affiliate_status":return"Creator/Afiliado";case"producer_status":return"Produtor";default:return e}};function Y(e){var s,l,a,t,n,r,o;let{viewItem:c,toggleDetail:d}=e;if(!c)return null;const u=null!==(s=null===(l=c.schedules)||void 0===l?void 0:l[0])&&void 0!==s?s:{},m=null!==(a=u.history)&&void 0!==a?a:[],h=null!==(t=m[m.length-1])&&void 0!==t?t:{};h.status;return(0,v.jsxs)(i.go,{direction:"end",isOpen:!!c,toggle:d,className:"notification-offcanvas-detail",children:[(0,v.jsxs)(i.$m,{toggle:d,children:["Detalhes da Notifica\xe7\xe3o #",c.id]}),(0,v.jsxs)(i.i1,{className:"pt-0",children:[(0,v.jsx)("h5",{className:"mt-1 mb-3 fw-semibold",children:c.title}),(0,v.jsxs)("div",{className:"d-flex flex-wrap gap-2 mb-3",children:[(0,v.jsx)(i.Ex,{color:"info",pill:!0,children:F(c.channel)}),(0,v.jsx)(i.Ex,{color:"primary",pill:!0,children:"immediate"===u.schedule_type?"Agora":"Agendado"}),void 0!==h.successful&&(0,v.jsxs)(i.Ex,{color:"success",pill:!0,children:[h.successful,"/",h.failed]})]}),c.image_url&&(0,v.jsx)("img",{src:c.image_url,alt:"banner",className:"rounded w-100 mb-3",style:{objectFit:"cover",maxHeight:180}}),(0,v.jsxs)("dl",{className:"row small mb-0",children:[(0,v.jsx)("dt",{className:"col-4",children:"Conte\xfado"}),(0,v.jsx)("dd",{className:"col-8",children:c.content||"\u2014"}),(0,v.jsx)("dt",{className:"col-4",children:"Link"}),(0,v.jsx)("dd",{className:"col-8",children:c.url?(0,v.jsxs)("a",{href:c.url,$1:!0,className:"break-link",title:c.url,children:[c.url," ",(0,v.jsx)(I.A,{size:12,className:"ms-1"})]}):"\u2014"}),(0,v.jsx)("dt",{className:"col-4",children:"Criada em"}),(0,v.jsx)("dd",{className:"col-8",children:T(c.created_at)}),(0,v.jsx)("dt",{className:"col-4",children:"Envio"}),(0,v.jsx)("dd",{className:"col-8",children:T(u.send_at)}),(0,v.jsx)("dt",{className:"col-4",children:"Tags"}),(0,v.jsxs)("dd",{className:"col-8",children:[((null===(n=c.audience)||void 0===n?void 0:n.tags)||[]).map(e=>(0,v.jsx)(i.Ex,{color:"dark",pill:!0,className:"me-1",children:U(e)},e)),!(null!==(r=c.audience)&&void 0!==r&&null!==(o=r.tags)&&void 0!==o&&o.length)&&"\u2014"]})]})]})]})}var P=l(13467);const O={rowsPerPageText:"Linhas por p\xe1gina",rangeSeparatorText:"de",selectAllRowsItem:!1},R=e=>new Promise(s=>setTimeout(s,e)),D=e=>new Date(e).toLocaleString("pt-BR",{dateStyle:"short",timeStyle:"short"}),L=e=>{switch(e){case"push":return"Push";case"email":return"Email";case"sms":return"SMS";default:return"\u2014"}},q=e=>{switch(e){case"user_status":return"Inativo";case"affiliate_status":return"Creator/Afiliado";case"producer_status":return"Produtor";default:return"\u2014"}},J=e=>{var s,l;return null!==(s=null===(l=e.schedules)||void 0===l?void 0:l[0])&&void 0!==s?s:{}};function z(e){let{filterText:s,onDelete:l}=e;const[t,n]=(0,a.useState)([]),[r,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(null),[u,h]=(0,a.useState)(!1),[g,j]=(0,a.useState)(null),{skin:p}=(0,P.h)(),f=(0,a.useCallback)(async()=>{o(!0);try{const{notifications:e}=await m();n(Array.isArray(e)?e:[])}catch(e){console.error("Erro ao carregar notifica\xe7\xf5es",e)}finally{o(!1)}},[]);(0,a.useEffect)(()=>{f()},[f]);const b=()=>{d(null),h(!1)},_=[{name:"ID",selector:e=>e.id,sortable:!0,minWidth:"70px",grow:0},{name:"Canal",cell:e=>L(e.channel),minWidth:"70px",grow:0},{name:"T\xedtulo",selector:e=>e.title,sortable:!0,minWidth:"140px",grow:2},{name:"Conte\xfado",selector:e=>e.content,wrap:!0,minWidth:"200px",grow:3},{name:"Tags",selector:e=>{var s,l;return null===(s=e.audience)||void 0===s||null===(l=s.tags)||void 0===l?void 0:l.map(q).join(", ")},wrap:!0,minWidth:"180px",grow:2},{name:"Tipo",cell:e=>{const s=J(e).schedule_type,l="immediate"===s?"Agora":"Agendado",a="immediate"===s?"info":"warning";return(0,v.jsx)("span",{className:"badge rounded-pill bg-".concat(a),children:l})},minWidth:"100px",grow:0},{name:"Envio",selector:e=>D(J(e).send_at),sortable:!0,minWidth:"160px",grow:0},{name:"Imagem",cell:e=>e.image_url?(0,v.jsx)("img",{src:e.image_url,alt:"thumb",style:{height:40,width:40,objectFit:"cover",borderRadius:4}}):"\u2014",ignoreRowClick:!0,allowOverflow:!0,minWidth:"80px",grow:0},{name:"Link",cell:e=>e.url?(0,v.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",style:{whiteSpace:"nowrap"},children:"Abrir"}):"\u2014",minWidth:"60px",grow:1},{name:"Criada em",selector:e=>D(e.created_at),sortable:!0,minWidth:"150px",grow:0},{name:"A\xe7\xf5es",right:!0,cell:e=>(0,v.jsx)(i.$n,{color:"flat-secondary",title:"Apagar",onClick:s=>{var l;s.stopPropagation(),l=e.id,d(l),h(!0)},style:{padding:"0.25rem"},children:(0,v.jsx)(S.A,{size:16})}),ignoreRowClick:!0,allowOverflow:!0,button:!0,minWidth:"80px",grow:0}],y=s?t.filter(e=>e.title.toLowerCase().includes(s.toLowerCase())||e.content.toLowerCase().includes(s.toLowerCase())):t;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(A.Ay,{noHeader:!0,columns:_,data:y,keyField:"id",fixedHeader:!0,fixedHeaderScrollHeight:"60vh",progressPending:r,pagination:!0,paginationComponentOptions:O,highlightOnHover:!0,pointerOnHover:!0,dense:!0,theme:"dark"===p?"solarized":"solarizedLight",noDataComponent:(0,v.jsxs)("div",{className:"d-flex flex-column align-items-center justify-content-center w-100 py-5",style:{minHeight:"200px"},children:[(0,v.jsx)(E.A,{size:48}),(0,v.jsx)("p",{className:"mt-1",children:"Nenhum registro para exibir"})]}),onRowClicked:e=>j(e)}),(0,v.jsx)(Y,{viewItem:g,toggleDetail:()=>j(null)}),(0,v.jsxs)(i.aF,{isOpen:u,toggle:b,centered:!0,children:[(0,v.jsx)(i.rQ,{toggle:b,children:"Confirmar exclus\xe3o"}),(0,v.jsxs)(i.cw,{children:["Tem certeza que deseja excluir a notifica\xe7\xe3o"," ",(0,v.jsx)("strong",{children:c}),"?"]}),(0,v.jsxs)(i.jl,{children:[(0,v.jsx)(i.$n,{color:"secondary",onClick:b,children:"Cancelar"}),(0,v.jsx)(i.$n,{color:"danger",onClick:async()=>{try{await x(c),b(),await R(350),f(),null===l||void 0===l||l()}catch(e){console.error("Erro ao apagar notifica\xe7\xe3o",e)}},children:"Excluir"})]})]})]})}function W(){const[e,s]=(0,a.useState)(!1),[l,n]=(0,a.useState)(!1),[r,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(""),u=(0,a.useCallback)(()=>{o(!0),s(e=>!e),setTimeout(()=>o(!1),300)},[]),m=()=>n(e=>!e);return(0,v.jsxs)("section",{className:"notification-page",children:[(0,v.jsx)("h2",{className:"mb-2",children:"Notifica\xe7\xf5es"}),(0,v.jsx)("p",{className:"text-muted mb-3",children:"Se comunique com creators/afiliados, produtores e usu\xe1rios inativos."}),(0,v.jsxs)(i.Zp,{children:[(0,v.jsx)(i.aR,{className:"d-flex align-items-center justify-content-end",children:(0,v.jsxs)(i.$n,{color:"primary",onClick:m,className:"btn-circle d-flex align-items-center justify-content-center",children:[(0,v.jsx)(t.A,{size:20}),(0,v.jsx)("span",{className:"d-none d-sm-inline ms-2",children:"Nova notifica\xe7\xe3o"})]})}),(0,v.jsx)(i.bw,{children:(0,v.jsx)(z,{filterText:c},String(e))})]}),(0,v.jsxs)(i.go,{direction:"end",isOpen:l,toggle:m,backdrop:!0,className:"notification-offcanvas",children:[(0,v.jsx)(i.$m,{toggle:m,children:"Criar notifica\xe7\xe3o"}),(0,v.jsx)(i.i1,{children:(0,v.jsx)(C,{onSuccess:()=>{m(),u()},onCancel:m})})]})]})}},94300:()=>{}}]);