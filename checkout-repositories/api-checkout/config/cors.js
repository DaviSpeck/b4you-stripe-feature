const cors = require('cors');
const logger = require('../utils/logger');

const allowedOrigins = [
  'https://www.google.com',
  'https://google.com',
  'https://gravacao-de-videos.myshopify.com',
  'https://d9169c-4d.myshopify.com',
  'https://checkout.b4you.com.br',
  'https://sandbox-checkout.b4you.com.br',
  'https://usebigboom.com.br',
  'https://popozuda.com.br',
  'https://beladescanso.com.br',
  'https://blumibeauty.com',
  'https://nanovitsuplementos.com.br',
  'https://savioraloja.com.br',
  'https://nuflowoficial.com',
  'https://bb4uoficial.com.br',
  'https://lojabb4u.com.br',
  'https://a93538-93.myshopify.com',
  'https://vilababyy.com.br',
  'https://lojalucence.com.br',
  'https://ecom.savioraloja.com.br',
  'https://arrojoeco.com.br',
  'https://lummbeauty.com.br',
  'https://usezencial.com.br',
  'https://rejuderme.com.br',
  'https://revelegaya.com',
  'https://www.revelegaya.com',
  'https://poddi.com.br',
  'https://littleduck.com.br',
  'https://supernutrition-2.myshopify.com',
  'https://loja.lucenceoficial.com',
  'https://visaracosmeticos.com',
  'https://www.sejacaverna.com',
  'https://www.sejacaverna.com.br',
  'https://sejacaverna.com.br',
  'https://nanovitnutrition.com.br',
  'https://7gef1h-wm.myshopify.com',
  'https://popozudaoficial.com',
  'https://www.popozudaoficial.com',
  'https://www.loja.popozudaoficial.com',
  'https://loja.popozudaoficial.com',
  'https://supernutrition.com.br',
  'https://store.supernutrition.com.br',
  'https://arrojoeco.com.br',
  'https://vidazdermo.com.br',
  'https://be.letzgum.com.br',
  'https://lojasaviorabrasil.com.br',
  'https://getcoffeeshop.com.br',
  'https://www.getcoffeeshop.com.br',
  'https://zerofrizz.com.br',
  'https://www.vidazdermo.com.br',
  'https://insidewellness.com.br',
  'https://rainhanativaclub.com.br',
  'https://vivapureoficial.com.br',
  'https://seguro.bluuesleep.com.br',
  'https://sejaziva.com.br',
  'https://sicco.com.br',
  'https://splicy.com.br',
  'https://seguro.bluue.com.br',
  'https://checkout-ts.b4you.com.br',
  'https://nandaintimus.com.br',
  'https://seguro.usebigboom.com.br',
  'https://seguro.rejuderme.com.br',
  'https://seguro.lumminagest.com.br',
  'https://138kfg-n6.myshopify.com',
  'https://seguro.multicolageno.com.br',
  'https://perruche.com.br',
  'https://prohibidofuel.com.br',
  'https://pay.b4you.com.br',
  'https://sandbox-checkout-ts.b4you.com.br',
  'https://weshot-brasil.myshopify.com',
  'https://easydnutrition.com',
  'https://easydnutrition.com.br',
  'https://adeusoficial.store',
  'https://new.evaskin.com.br',
  'https://seguro.dreamscoffee.com.br',
  'https://seguro.greemy.com.br',
  'https://nyliacare.com.br',
  'https://dermosec.com.br',
  'https://www.ydecory.com.br',
  'https://thegutglow.com.br',
  'https://lummibrazil.com.br',
  'https://creagum.com.br',
  'https://pv.b4you.com.br',
  'https://juliaalazari.com',
  'https://mariaivancosmeticos.com.br',
  'https://seguro.dreamsburn.com.br',
  'https://seguro.lummibrazil.com.br',
  'https://cognion.com.br',
  'https://www.cognion.com.br',
  'https://coleemmim.com.br',
  'https://seguro.lipomonster.com.br',
  'https://lumyss.com.br',
  'https://avenaplus.com.br',
  'https://natuggi.com.br',
  'https://checkout.avenaplus.com.br',
  'https://www.biabellaboom.com.br',
  'https://biabellaboom.com.br',
  'https://somosmimy.com',
  'https://perfumeshopping.com.br',
  'https://www.perfumeshopping.com.br',
  'https://dev.perfumeshopping.com.br',
  'https://19nweh-t1.myshopify.com',
  'https://www.gourmetics.com.br',
  'https://gourmetics.com.br',
  'https://seguro.nutriccionforlife.com.br',
  'https://www.orperfumaria.com.br',
  'https://orperfumaria.com.br',
  'https://www.coleemmim.com',
  'https://coleemmim.com',
  'https://revien-cosmeticos.myshopify.com',
  'https://www.revien.com.br',
  'https://revien.com.br',
  'https://bivy.com.br',
  'https://bivy-5995.myshopify.com',
  'https://shop.microdoselife.com.br',
  'https://www.veluzze.com.br',
  'https://use-thermal.myshopify.com',
  'https://soliv.care',
  'https://intimia4u.com.br',
  'https://usethermal.com.br',
  'https://gleicypontesbeauty.com',
  'https://seguro.nandaintimus.com.br',
  'https://seguro.sejaziva.com.br',
  'https://pagamento.sejaziva.com.br',
  'https://cremebaibai.com.br',
  'https://sekeyoficial.com.br',
  'https://usenandaintimus.com.br',
  'https://www.veganbloom.com.br',
  'https://usepowerglam.com.br',
  'https://b4you-9615.myshopify.com',
  'https://seguro.omounjaronatural.com.br',
  'https://glowzao.com.br',
  'https://yohmireoficial.com',
  'https://usebearry.com.br',
  'https://seguro.usebearry.com.br',
  'https://b4you-9615.myshopify.com'
];

module.exports = cors({
  credentials: true,
  exposedHeaders: ['Content-Disposition'],
  origin: (origin, cb) => {
    if (!origin || allowedOrigins.includes(origin)) {
      cb(null, true);
    } else {
      logger.warn(`[CORS BLOCKED] Origin bloqueado: ${origin}`);
      cb(new Error(`Not allowed by CORS  ${origin}`));
    }
  },
});
